<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Chat with "Sigma AI" â€” HTML Only Demo</title>
<style>
  :root{
    --bg:#0b0f17; --card:#0f1720; --accent:#1e90ff; --muted:#9aa6b2; --bubble:#111827;
    color-scheme: dark;
  }
  html,body{height:100%;margin:0;font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue";background:linear-gradient(180deg,#020617 0%, #081226 100%); color: #e6eef6;}
  .app{max-width:920px;margin:28px auto;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;overflow:hidden;box-shadow:0 8px 40px rgba(2,6,23,0.6);}
  header{display:flex;align-items:center;gap:14px;padding:16px 20px;background:linear-gradient(90deg, rgba(255,255,255,0.02), transparent);border-bottom:1px solid rgba(255,255,255,0.03)}
  header h1{margin:0;font-size:18px;letter-spacing:0.2px}
  .main{display:grid;grid-template-columns:1fr 340px;min-height:560px}
  .chat{padding:18px;display:flex;flex-direction:column;gap:12px;min-height:560px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent)}
  .messages{flex:1;overflow:auto;padding-right:8px;display:flex;flex-direction:column;gap:10px}
  .msg{max-width:78%;padding:10px 14px;border-radius:12px;line-height:1.35;font-size:14px}
  .user{align-self:flex-end;background:linear-gradient(180deg,#063b8b,#0456d1);color:white;border-bottom-right-radius:4px}
  .ai{align-self:flex-start;background:var(--bubble);border:1px solid rgba(255,255,255,0.02);color:var(--muted)}
  .meta{font-size:12px;color:var(--muted);margin-bottom:6px}
  .composer{display:flex;gap:8px;padding:12px;border-top:1px solid rgba(255,255,255,0.02);background:linear-gradient(180deg, transparent, rgba(255,255,255,0.01))}
  textarea{flex:1;padding:12px;border-radius:10px;background:#061022;border:1px solid rgba(255,255,255,0.02);color:inherit;resize:none;height:56px}
  button{background:var(--accent);border:none;padding:10px 14px;border-radius:10px;color:white;cursor:pointer}
  aside{border-left:1px solid rgba(255,255,255,0.02);padding:18px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent)}
  .aside-section{margin-bottom:16px}
  label{display:block;font-size:12px;color:var(--muted);margin-bottom:8px}
  .opt{display:flex;gap:8px;align-items:center}
  .small{font-size:13px;color:var(--muted)}
  .img-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:8px;margin-top:10px}
  .img-grid img{width:100%;height:120px;object-fit:cover;border-radius:8px}
  footer{padding:10px 18px;font-size:12px;color:var(--muted);text-align:center;background:linear-gradient(90deg, transparent, rgba(255,255,255,0.01))}
  .pill{background:rgba(255,255,255,0.03);padding:6px 8px;border-radius:999px;font-size:12px}
  .switch{display:inline-flex;align-items:center;gap:6px}
  .badge{font-size:11px;padding:4px 8px;border-radius:999px;background:#0b1220;color:var(--muted);border:1px solid rgba(255,255,255,0.02)}
  /* scrollbar neatness */
  .messages::-webkit-scrollbar{width:10px}
  .messages::-webkit-scrollbar-thumb{background:rgba(255,255,255,0.03);border-radius:10px}
</style>
</head>
<body>
<div class="app" role="application">
  <header>
    <div style="width:44px;height:44px;border-radius:10px;background:linear-gradient(180deg,#062a3c,#081b2e);display:flex;align-items:center;justify-content:center;font-weight:700;color:var(--accent)">Î£</div>
    <div>
      <h1>Sigma AI â€” chat + image demo</h1>
      <div style="font-size:12px;color:var(--muted)">HTML-only UI â€” mock mode included. For real AI, connect a backend. âœ¨</div>
    </div>
    <div style="margin-left:auto" class="pill">No keys in browser pls</div>
  </header>

  <div class="main">
    <section class="chat" aria-label="Chat area">
      <div class="meta small">Chat history â€” local only (stored in browser). Try: "Draw a blue dragon" or "What's a sad playlist?"</div>
      <div id="messages" class="messages" aria-live="polite"></div>

      <div class="composer">
        <textarea id="inp" placeholder="Say something cool... (Shift+Enter = newline)"></textarea>
        <div style="display:flex;flex-direction:column;gap:8px">
          <button id="send">Send</button>
          <button id="imgbtn" title="Generate image">Generate Image</button>
        </div>
      </div>
    </section>

    <aside>
      <div class="aside-section">
        <label>Mode</label>
        <div class="opt">
          <select id="mode">
            <option value="mock">Mock AI (no API) â€” instant lol</option>
            <option value="server">Use your Server (recommended)</option>
            <option value="direct">Direct fetch to OpenAI (NOT recommended)</option>
          </select>
        </div>
        <div style="margin-top:8px;font-size:12px;color:var(--muted)">
          If you pick <b>server</b>, point endpoints to <code>/api/chat</code> and <code>/api/image</code>. See comments in the code below.
        </div>
      </div>

      <div class="aside-section">
        <label>Image Gallery</label>
        <div id="img-grid" class="img-grid"></div>
      </div>

      <div class="aside-section">
        <label>Quick prompts</label>
        <div style="display:flex;flex-direction:column;gap:8px">
          <button class="small quick" data-prompt="Write me a 2-line sad verse">Sad verse</button>
          <button class="small quick" data-prompt="Explain global warming in Grade 5 terms">Explain (Grade 5)</button>
          <button class="small quick" data-prompt="Design a futuristic black-and-blue album cover with moody vibes">Album cover idea</button>
        </div>
      </div>

      <div class="aside-section">
        <label>Tips</label>
        <div class="small" style="color:var(--muted)">
          â€¢ Mock mode fakes responses so you can test UI. <br>
          â€¢ For real AI responses, run a tiny serverless function that calls OpenAI and returns results to this UI. <br>
          â€¢ Never paste your OpenAI API key into client-side JS. Keep it server-side.
        </div>
      </div>
    </aside>
  </div>

  <footer>Made for you. Gen Z vibes. Use responsibly. ðŸ˜Ž</footer>
</div>

<script>
/*
  How to connect to a real AI (summary):
  - Implement server endpoints:
      POST /api/chat   -> body { message: "..." }    -> server calls OpenAI ChatCompletion and returns { reply: "..." }
      POST /api/image  -> body { prompt: "..." }     -> server calls OpenAI Image API or other model and returns { images: ["url1","url2"] }
  - Keep your API key on the server. Browser calls your endpoints only.
  - If you absolutely want to prototype with a key in-browser (bad idea), choose mode "direct" and change DIRECT_API_URL below.
*/

/* ===== CONFIG ===== */
const CONFIG = {
  // If you choose "direct" mode, set DIRECT_API_URL to the full OpenAI endpoint
  // (NOT recommended; this would expose keys in client). Best: use "server" mode and implement /api/chat & /api/image.
  DIRECT_API_URL: "https://api.openai.com/v1/chat/completions", // placeholder
  // Server endpoints (examples). If you choose "server" mode, your server should implement these routes:
  SERVER_CHAT: "/api/chat",
  SERVER_IMAGE: "/api/image"
};
/* =================== */

const messagesEl = document.getElementById('messages');
const inp = document.getElementById('inp');
const sendBtn = document.getElementById('send');
const imgBtn = document.getElementById('imgbtn');
const modeSel = document.getElementById('mode');
const imgGrid = document.getElementById('img-grid');

let history = JSON.parse(localStorage.getItem('sigma_history_v1')||'[]');

function renderMessages(){
  messagesEl.innerHTML = '';
  for(const m of history){
    const d = document.createElement('div');
    d.className = 'msg ' + (m.role==='user'?'user':'ai');
    if(m.role==='ai'){
      const meta = document.createElement('div'); meta.className='meta small'; meta.textContent = 'Sigma AI';
      d.appendChild(meta);
    }
    const txt = document.createElement('div'); txt.innerHTML = m.content.replace(/\n/g,'<br>');
    d.appendChild(txt);
    messagesEl.appendChild(d);
  }
  messagesEl.scrollTop = messagesEl.scrollHeight;
}
renderMessages();

function saveHistory(){ localStorage.setItem('sigma_history_v1', JSON.stringify(history)); }

function pushMessage(role, content){
  history.push({role, content, ts: Date.now()});
  if(history.length>60) history = history.slice(-60);
  saveHistory();
  renderMessages();
}

function mockReply(userTxt){
  // playful Gen Z style mock response
  const replies = [
    "Bet â€” I gotchu. So basically: " + userTxt,
    "Aight here's a vibe: " + userTxt,
    "Lowkey that slaps. Thoughts: " + userTxt,
    "OKAY, imagine this: " + userTxt,
    "I would say: " + userTxt
  ];
  // make it look like an answer with a tiny delay
  return new Promise(res => setTimeout(()=>res(replies[Math.floor(Math.random()*replies.length)] + " âœ¨"), 700 + Math.random()*900));
}

async function callServerChat(message){
  // expects JSON { reply: "..." }
  const resp = await fetch(CONFIG.SERVER_CHAT, {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify({ message })
  });
  if(!resp.ok){
    const t = await resp.text();
    throw new Error('Server error: ' + t);
  }
  return resp.json();
}

async function callServerImage(prompt){
  // expects JSON { images: ["https://...","data:image/png;base64,..."] }
  const resp = await fetch(CONFIG.SERVER_IMAGE, {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify({ prompt })
  });
  if(!resp.ok){
    const t = await resp.text();
    throw new Error('Server image error: ' + t);
  }
  return resp.json();
}

async function callDirectOpenAI(message){
  // VERY BAD to use in-browser; this is a placeholder to show where direct fetch would go.
  // You would need to provide headers with Authorization Bearer <API_KEY> here.
  // This function is intentionally not implemented for safety.
  throw new Error('Direct browser calls to OpenAI are disabled in this demo. Use server mode.');
}

sendBtn.addEventListener('click', async()=>{
  const txt = inp.value.trim();
  if(!txt) return;
  pushMessage('user', txt);
  inp.value = '';
  // optimistic UI
  pushMessage('ai', '...thinking');
  const mode = modeSel.value;
  try{
    let aiText = '';
    if(mode === 'mock'){
      aiText = await mockReply(txt);
    } else if(mode === 'server'){
      const res = await callServerChat(txt);
      // server should return { reply: "..." }
      aiText = res.reply || JSON.stringify(res);
    } else {
      const res = await callDirectOpenAI(txt);
      aiText = res.reply || JSON.stringify(res);
    }
    // replace the last ai "thinking" with actual
    if(history.length && history[history.length-1].content === '...thinking' && history[history.length-1].role === 'ai'){
      history[history.length-1].content = aiText;
    } else {
      pushMessage('ai', aiText);
    }
    saveHistory();
    renderMessages();
  }catch(err){
    // error handling: replace thinking with error text
    if(history.length && history[history.length-1].content === '...thinking' && history[history.length-1].role === 'ai'){
      history[history.length-1].content = 'Error: ' + err.message;
    } else {
      pushMessage('ai', 'Error: ' + err.message);
    }
    saveHistory();
    renderMessages();
  }
});

imgBtn.addEventListener('click', async()=>{
  const prompt = inp.value.trim() || promptFallback();
  if(!prompt) return alert('Type an image prompt first ðŸ˜…');
  pushMessage('user', 'Image: ' + prompt);
  pushMessage('ai', 'Generating image...');
  const mode = modeSel.value;
  try{
    let imgs = [];
    if(mode === 'mock'){
      // generate placeholder images (picsum + seeded)
      imgs = [
        'https://picsum.photos/seed/' + encodeURIComponent(prompt+Date.now()) + '/512/384',
        'https://picsum.photos/seed/' + encodeURIComponent(prompt+'alt') + '/512/384'
      ];
    } else if(mode === 'server'){
      const res = await callServerImage(prompt);
      imgs = res.images || [];
    } else {
      // direct mode not implemented
      throw new Error('Direct image generation in-browser is disabled. Use server mode.');
    }

    // replace last "Generating image..." with text and show images
    if(history.length && history[history.length-1].content === 'Generating image...' && history[history.length-1].role === 'ai'){
      history[history.length-1].content = 'Here are some images for: ' + prompt;
    } else {
      pushMessage('ai', 'Here are some images for: ' + prompt);
    }
    saveHistory();
    renderMessages();

    // show images in side gallery
    imgGrid.innerHTML = '';
    imgs.forEach(u=>{
      const img = document.createElement('img');
      img.src = u;
      img.alt = prompt;
      imgGrid.appendChild(img);
    });
  }catch(err){
    if(history.length && history[history.length-1].content === 'Generating image...' && history[history.length-1].role === 'ai'){
      history[history.length-1].content = 'Image error: ' + err.message;
    } else {
      pushMessage('ai', 'Image error: ' + err.message);
    }
    saveHistory();
    renderMessages();
  }
});

function promptFallback(){ return inp.value.trim() || 'A moody black-and-blue album cover, futuristic, cinematic lighting'; }

// quick prompts
document.querySelectorAll('.quick').forEach(btn=>{
  btn.addEventListener('click', ()=>{ inp.value = btn.dataset.prompt; inp.focus(); });
});

// keyboard: Enter to send
inp.addEventListener('keydown', (e)=>{
  if(e.key === 'Enter' && !e.shiftKey){
    e.preventDefault();
    sendBtn.click();
  }
});
</script>
</body>
</html>
